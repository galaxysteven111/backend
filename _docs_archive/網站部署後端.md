# 🌐 使用 Railway 網站部署後端（無需 CLI）

## ✅ 這是最簡單的方式！

不需要安裝 Railway CLI，直接在網站上操作。

---

## 📋 步驟

### 步驟 1：訪問 Railway

1. 前往 https://railway.app
2. 使用 GitHub 登錄（如果沒有帳號，先註冊）

---

### 步驟 2：創建新項目

1. 點擊 **"New Project"**
2. 選擇 **"Deploy from GitHub repo"**
3. 選擇你的倉庫（如果沒有連接，先連接 GitHub）
4. 選擇倉庫後，Railway 會自動開始部署

---

### 步驟 3：設置 Root Directory

1. 點擊你的服務（剛創建的）
2. 點擊 **"Settings"** 標籤
3. 找到 **"Root Directory"**
4. 設置為：`backend`
5. Railway 會自動重新部署

---

### 步驟 4：添加 PostgreSQL 數據庫

1. 在項目頁面，點擊 **"New"**
2. 選擇 **"Database"** → **"PostgreSQL"**
3. Railway 會自動創建數據庫
4. ✅ `DATABASE_URL` 會自動設置（無需手動配置）

---

### 步驟 5：生成 JWT_SECRET

在本地終端運行：

```powershell
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

**複製生成的密鑰**（長字符串）

---

### 步驟 6：設置環境變量

1. 在服務設置頁面
2. 點擊 **"Variables"** 標籤
3. 點擊 **"New Variable"**，添加以下變量：

   **變量 1**：
   - Key: `NODE_ENV`
   - Value: `production`

   **變量 2**：
   - Key: `JWT_SECRET`
   - Value: `你的密鑰`（步驟 5 生成的）

   **變量 3**：
   - Key: `FRONTEND_URL`
   - Value: `http://localhost:3000`（稍後更新）

4. 點擊 **"Add"** 保存每個變量

---

### 步驟 7：運行數據庫遷移

**方法 1：使用 Shell（推薦）**

1. 在服務頁面，點擊 **"Deployments"** 標籤
2. 點擊最新的部署
3. 點擊 **"View Logs"**
4. 點擊 **"Shell"** 標籤
5. 運行：
   ```bash
   npm run migrate:prod
   ```

**方法 2：使用 Post Deploy Command**

1. 在服務設置頁面
2. 找到 **"Deploy"** 標籤
3. 找到 **"Post Deploy Command"**
4. 輸入：`npm run migrate:prod`
5. 保存設置
6. Railway 會在每次部署後自動運行遷移

---

### 步驟 8：獲取 API URL

1. 在服務設置頁面
2. 找到 **"Networking"** 標籤
3. 點擊 **"Generate Domain"**
4. Railway 會生成一個域名，例如：`your-app.up.railway.app`
5. **記下這個 URL**

**API 基礎 URL** 是：`https://your-app.up.railway.app/api`

---

## ✅ 完成！

部署完成後，你會得到：
- **後端 API URL**: `https://your-app.up.railway.app/api`

---

## 🧪 測試部署

在瀏覽器訪問：
```
https://your-app.up.railway.app/health
```

應該看到：
```json
{
  "status": "ok",
  "database": {
    "connected": true,
    "latency": "..."
  },
  "version": "1.0.0",
  "environment": "production"
}
```

---

## 🔄 下一步：部署前端

部署完後端後：
1. 記下 API URL
2. 在 Netlify 設置 `VITE_API_URL` 環境變量
3. 更新 Railway 的 `FRONTEND_URL` 為你的 Netlify URL

---

## 💡 提示

- Railway 會自動監聽 GitHub 推送，每次推送會自動部署
- 可以在 "Deployments" 標籤查看部署狀態和日誌
- 如果部署失敗，查看日誌找出問題

---

**現在開始部署吧！訪問 https://railway.app** 🚀
